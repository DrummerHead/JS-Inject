<!doctype html>
<html>
<head>
  <title>timeBar</title>
  <meta name='author' content='DrummerHead'>
  <link rel='stylesheet' href='../../css/promiscuous.css'>
  <link rel='stylesheet' href='examples.css'>
</head>
<body>

<header id='quoin'>
  <div id='brand'>
    <a href='/' title='Go to mcdlr homepage'>Go to mcdlr homepage</a>
  </div>
  <div id='octo-peek'>
    <a href='https://github.com/DrummerHead/JS-Inject/blob/master/examples/minutedock.js' rel='external'><span>Fork me on Github!</span></a>
  </div>
</header>

<small>Drag the below link to your bookmarks</small>
<a href="javascript:(function(){ var today = new Date() , todayStarted = new Date().setHours(0, 0, 0, 0) , miliInADay = 86400000 , miliInAWorkingWeek = miliInADay * 5 , miliInAMonth = miliInADay * 30 , rightNow = today.getTime() , miliElapsedToday = rightNow - todayStarted , dayPercentage = miliElapsedToday * 100 / miliInADay , weekDay = (today.getDay() + 6) %257 , weekDayMili = weekDay * miliInADay , miliElapsedInWeek = weekDayMili + miliElapsedToday , weekPercentageOverflow = miliElapsedInWeek * 100 / miliInAWorkingWeek , weekPercentage = ( weekPercentageOverflow < 100 ? weekPercentageOverflow : 100 ) , monthFirstDay = today.setDate(1) , monthBegins = today.setHours(0, 0, 0, 0) , monthNow = rightNow - monthBegins , monthPercentage = monthNow * 100 / miliInAMonth , $brief = $$(%27.brief%27) , regexMonthly = /monthly/ , regexWeekly = /weekly/ , regexDaily = /daily/ ; var makeTimeBar = function(percentageDelta, isWorkAboveTime, timePercentage){ var barHTML = %27<div class=%22progress_bar_track%22 title=%22TimeBar &#183; Percentage delta = %27 + percentageDelta + %27%25%22><div class=%22progress_bar%27 + (isWorkAboveTime ? %27 green%27 : %27 red%27) + %27%22><div style=%22width: %27 + timePercentage + %27%25%22 class=%22progress%22></div></div></div>%27; return barHTML }; $brief.each(function(el){ var periodText = el.down(%27.normal .period%27).textContent.strip() , $progressBarTrack = el.down(%27.progress_bar_track%27) , $progress = el.down(%27.progress%27) , progressPercentage = ( $progress ? parseInt(el.down(%27.progress%27).getStyle(%27width%27)) : 0 ) , isMonth = regexMonthly.test(periodText) , isWeek = regexWeekly.test(periodText) , isDay = regexDaily.test(periodText) , timePercentage ; if(isMonth){ timePercentage = monthPercentage } else if(isWeek){ timePercentage = weekPercentage } else if(isDay){ timePercentage = dayPercentage } var isWorkAboveTime = progressPercentage >= timePercentage , percentageDelta = (progressPercentage - timePercentage).toFixed(1) ; $progressBarTrack.insert({after : makeTimeBar(percentageDelta, isWorkAboveTime, timePercentage)}); }); })();">timeBar</a>

</body>
</html>
